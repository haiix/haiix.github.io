(()=>{"use strict";var t={926:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.setMatrixArrayType=function(t){e.ARRAY_TYPE=n=t},e.toRadian=function(t){return t*a},e.equals=function(t,e){return Math.abs(t-e)<=r*Math.max(1,Math.abs(t),Math.abs(e))},e.RANDOM=e.ARRAY_TYPE=e.EPSILON=void 0;var r=1e-6;e.EPSILON=r;var n="undefined"!=typeof Float32Array?Float32Array:Array;e.ARRAY_TYPE=n;var i=Math.random;e.RANDOM=i;var a=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},761:(t,e,r)=>{function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){var t=new i.ARRAY_TYPE(9);return i.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},e.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},e.clone=function(t){var e=new i.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromValues=function(t,e,r,n,a,o,s,u,c){var h=new i.ARRAY_TYPE(9);return h[0]=t,h[1]=e,h[2]=r,h[3]=n,h[4]=a,h[5]=o,h[6]=s,h[7]=u,h[8]=c,h},e.set=function(t,e,r,n,i,a,o,s,u,c){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},e.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=h*o-s*c,l=-h*a+s*u,p=c*a-o*u,d=r*f+n*l+i*p;return d?(d=1/d,t[0]=f*d,t[1]=(-h*n+i*c)*d,t[2]=(s*n-i*o)*d,t[3]=l*d,t[4]=(h*r-i*u)*d,t[5]=(-s*r+i*a)*d,t[6]=p*d,t[7]=(-c*r+n*u)*d,t[8]=(o*r-n*a)*d,t):null},e.adjoint=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],h=e[8];return t[0]=o*h-s*c,t[1]=i*c-n*h,t[2]=n*s-i*o,t[3]=s*u-a*h,t[4]=r*h-i*u,t[5]=i*a-r*s,t[6]=a*c-o*u,t[7]=n*u-r*c,t[8]=r*o-n*a,t},e.determinant=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],u=t[7],c=t[8];return e*(c*a-o*u)+r*(-c*i+o*s)+n*(u*i-a*s)},e.multiply=o,e.translate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=r[0],p=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=u,t[6]=l*n+p*o+c,t[7]=l*i+p*s+h,t[8]=l*a+p*u+f,t},e.rotate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=Math.sin(r),p=Math.cos(r);return t[0]=p*n+l*o,t[1]=p*i+l*s,t[2]=p*a+l*u,t[3]=p*o-l*n,t[4]=p*s-l*i,t[5]=p*u-l*a,t[6]=c,t[7]=h,t[8]=f,t},e.scale=function(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},e.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},e.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r+r,s=n+n,u=i+i,c=r*o,h=n*o,f=n*s,l=i*o,p=i*s,d=i*u,m=a*o,v=a*s,b=a*u;return t[0]=1-f-d,t[3]=h-b,t[6]=l+v,t[1]=h+b,t[4]=1-c-d,t[7]=p-m,t[2]=l-v,t[5]=p+m,t[8]=1-c-f,t},e.normalFromMat4=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],p=e[11],d=e[12],m=e[13],v=e[14],b=e[15],y=r*s-n*o,E=r*u-i*o,M=r*c-a*o,g=n*u-i*s,_=n*c-a*s,A=i*c-a*u,R=h*m-f*d,T=h*v-l*d,w=h*b-p*d,S=f*v-l*m,x=f*b-p*m,O=l*b-p*v,P=y*O-E*x+M*S+g*w-_*T+A*R;return P?(P=1/P,t[0]=(s*O-u*x+c*S)*P,t[1]=(u*w-o*O-c*T)*P,t[2]=(o*x-s*w+c*R)*P,t[3]=(i*x-n*O-a*S)*P,t[4]=(r*O-i*w+a*T)*P,t[5]=(n*w-r*x-a*R)*P,t[6]=(m*A-v*_+b*g)*P,t[7]=(v*M-d*A-b*E)*P,t[8]=(d*_-m*M+b*y)*P,t):null},e.projection=function(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},e.subtract=s,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},e.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},e.equals=function(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=t[6],h=t[7],f=t[8],l=e[0],p=e[1],d=e[2],m=e[3],v=e[4],b=e[5],y=e[6],E=e[7],M=e[8];return Math.abs(r-l)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-p)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(a-d)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(o-m)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-v)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-b)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(c-y)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(h-E)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(f-M)<=i.EPSILON*Math.max(1,Math.abs(f),Math.abs(M))},e.sub=e.mul=void 0;var i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=t[o]}return r.default=t,e&&e.set(t,r),r}(r(926));function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function o(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=r[0],p=r[1],d=r[2],m=r[3],v=r[4],b=r[5],y=r[6],E=r[7],M=r[8];return t[0]=l*n+p*o+d*c,t[1]=l*i+p*s+d*h,t[2]=l*a+p*u+d*f,t[3]=m*n+v*o+b*c,t[4]=m*i+v*s+b*h,t[5]=m*a+v*u+b*f,t[6]=y*n+E*o+M*c,t[7]=y*i+E*s+M*h,t[8]=y*a+E*u+M*f,t}function s(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}var u=o;e.mul=u;var c=s;e.sub=c},529:(t,e,r)=>{function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.Ue=function(){var t=new i.ARRAY_TYPE(16);return i.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},e.Iu=function(t,e,r){var n,i,a,o,s,u,c,h,f,l,p,d,m=r[0],v=r[1],b=r[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*b+e[12],t[13]=e[1]*m+e[5]*v+e[9]*b+e[13],t[14]=e[2]*m+e[6]*v+e[10]*b+e[14],t[15]=e[3]*m+e[7]*v+e[11]*b+e[15]):(n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=e[9],p=e[10],d=e[11],t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=u,t[6]=c,t[7]=h,t[8]=f,t[9]=l,t[10]=p,t[11]=d,t[12]=n*m+s*v+f*b+e[12],t[13]=i*m+u*v+l*b+e[13],t[14]=a*m+c*v+p*b+e[14],t[15]=o*m+h*v+d*b+e[15]),t},e.yl=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=n+n,u=i+i,c=a+a,h=n*s,f=n*u,l=n*c,p=i*u,d=i*c,m=a*c,v=o*s,b=o*u,y=o*c;return t[0]=1-(p+m),t[1]=f+y,t[2]=l-b,t[3]=0,t[4]=f-y,t[5]=1-(h+m),t[6]=d+v,t[7]=0,t[8]=l+b,t[9]=d-v,t[10]=1-(h+p),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},e.G3=function(t,e,r,n,i){var a,o=1/Math.tan(e/2);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(n-i),t[10]=(i+n)*a,t[14]=2*i*n*a):(t[10]=-1,t[14]=-2*n),t},e.dC=void 0;var i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=t[o]}return r.default=t,e&&e.set(t,r),r}(r(926));function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var o=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=e[9],p=e[10],d=e[11],m=e[12],v=e[13],b=e[14],y=e[15],E=r[0],M=r[1],g=r[2],_=r[3];return t[0]=E*n+M*s+g*f+_*m,t[1]=E*i+M*u+g*l+_*v,t[2]=E*a+M*c+g*p+_*b,t[3]=E*o+M*h+g*d+_*y,E=r[4],M=r[5],g=r[6],_=r[7],t[4]=E*n+M*s+g*f+_*m,t[5]=E*i+M*u+g*l+_*v,t[6]=E*a+M*c+g*p+_*b,t[7]=E*o+M*h+g*d+_*y,E=r[8],M=r[9],g=r[10],_=r[11],t[8]=E*n+M*s+g*f+_*m,t[9]=E*i+M*u+g*l+_*v,t[10]=E*a+M*c+g*p+_*b,t[11]=E*o+M*h+g*d+_*y,E=r[12],M=r[13],g=r[14],_=r[15],t[12]=E*n+M*s+g*f+_*m,t[13]=E*i+M*u+g*l+_*v,t[14]=E*a+M*c+g*p+_*b,t[15]=E*o+M*h+g*d+_*y,t};e.dC=o},765:(t,e,r)=>{function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.Ue=h,e.lM=function(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+o*s,t[1]=i*u+a*s,t[2]=a*u-i*s,t[3]=o*u-n*s,t},e.uD=function(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u-a*s,t[1]=i*u+o*s,t[2]=a*u+n*s,t[3]=o*u-i*s,t},e.jI=function(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+i*s,t[1]=i*u-n*s,t[2]=a*u+o*s,t[3]=o*u-a*s,t};var i=c(r(926)),a=c(r(761)),o=c(r(16)),s=c(r(146));function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function c(t){if(t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var o=i?Object.getOwnPropertyDescriptor(t,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=t[a]}return r.default=t,e&&e.set(t,r),r}function h(){var t=new i.ARRAY_TYPE(4);return i.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}s.clone,s.fromValues,s.copy,s.set,s.add;s.scale,s.dot;s.lerp;s.length,s.squaredLength,s.normalize;s.exactEquals,s.equals,o.create(),o.fromValues(1,0,0),o.fromValues(0,1,0),h(),h(),a.create()},16:(t,e,r)=>{function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.create=o,e.clone=function(t){var e=new i.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.length=s,e.fromValues=function(t,e,r){var n=new i.ARRAY_TYPE(3);return n[0]=t,n[1]=e,n[2]=r,n},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},e.subtract=u,e.multiply=c,e.divide=h,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},e.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},e.distance=f,e.squaredDistance=l,e.squaredLength=p,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},e.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t},e.dot=d,e.cross=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],s=r[1],u=r[2];return t[0]=i*u-a*s,t[1]=a*o-n*u,t[2]=n*s-i*o,t},e.lerp=function(t,e,r,n){var i=e[0],a=e[1],o=e[2];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=o+n*(r[2]-o),t},e.hermite=function(t,e,r,n,i,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,c=o*(a-1),h=o*(3-2*a);return t[0]=e[0]*s+r[0]*u+n[0]*c+i[0]*h,t[1]=e[1]*s+r[1]*u+n[1]*c+i[1]*h,t[2]=e[2]*s+r[2]*u+n[2]*c+i[2]*h,t},e.bezier=function(t,e,r,n,i,a){var o=1-a,s=o*o,u=a*a,c=s*o,h=3*a*s,f=3*u*o,l=u*a;return t[0]=e[0]*c+r[0]*h+n[0]*f+i[0]*l,t[1]=e[1]*c+r[1]*h+n[1]*f+i[1]*l,t[2]=e[2]*c+r[2]*h+n[2]*f+i[2]*l,t},e.random=function(t,e){e=e||1;var r=2*i.RANDOM()*Math.PI,n=2*i.RANDOM()-1,a=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*a,t[1]=Math.sin(r)*a,t[2]=n*e,t},e.transformMat4=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,t[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,t[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,t[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,t},e.transformMat3=function(t,e,r){var n=e[0],i=e[1],a=e[2];return t[0]=n*r[0]+i*r[3]+a*r[6],t[1]=n*r[1]+i*r[4]+a*r[7],t[2]=n*r[2]+i*r[5]+a*r[8],t},e.transformQuat=function(t,e,r){var n=r[0],i=r[1],a=r[2],o=r[3],s=e[0],u=e[1],c=e[2],h=i*c-a*u,f=a*s-n*c,l=n*u-i*s,p=i*l-a*f,d=a*h-n*l,m=n*f-i*h,v=2*o;return h*=v,f*=v,l*=v,p*=2,d*=2,m*=2,t[0]=s+h+p,t[1]=u+f+d,t[2]=c+l+m,t},e.rotateX=function(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},e.rotateY=function(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},e.rotateZ=function(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},e.angle=function(t,e){var r=t[0],n=t[1],i=t[2],a=e[0],o=e[1],s=e[2],u=Math.sqrt(r*r+n*n+i*i)*Math.sqrt(a*a+o*o+s*s),c=u&&d(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))},e.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},e.equals=function(t,e){var r=t[0],n=t[1],a=t[2],o=e[0],s=e[1],u=e[2];return Math.abs(r-o)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-u)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))},e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0;var i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=t[o]}return r.default=t,e&&e.set(t,r),r}(r(926));function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function o(){var t=new i.ARRAY_TYPE(3);return i.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function s(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function u(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function c(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function h(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function f(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.hypot(r,n,i)}function l(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i}function p(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function d(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}var m=u;e.sub=m;var v=c;e.mul=v;var b=h;e.div=b;var y=f;e.dist=y;var E=l;e.sqrDist=E;var M=s;e.len=M;var g=p;e.sqrLen=g;var _,A=(_=o(),function(t,e,r,n,i,a){var o,s;for(e||(e=3),r||(r=0),s=n?Math.min(n*e+r,t.length):t.length,o=r;o<s;o+=e)_[0]=t[o],_[1]=t[o+1],_[2]=t[o+2],i(_,_,a),t[o]=_[0],t[o+1]=_[1],t[o+2]=_[2];return t});e.forEach=A},146:(t,e,r)=>{function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.create=o,e.clone=function(t){var e=new i.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.fromValues=function(t,e,r,n){var a=new i.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set=function(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},e.subtract=s,e.multiply=u,e.divide=c,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},e.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},e.distance=h,e.squaredDistance=f,e.length=l,e.squaredLength=p,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},e.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=r*o,t[1]=n*o,t[2]=i*o,t[3]=a*o,t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},e.cross=function(t,e,r,n){var i=r[0]*n[1]-r[1]*n[0],a=r[0]*n[2]-r[2]*n[0],o=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],u=r[1]*n[3]-r[3]*n[1],c=r[2]*n[3]-r[3]*n[2],h=e[0],f=e[1],l=e[2],p=e[3];return t[0]=f*c-l*u+p*s,t[1]=-h*c+l*o-p*a,t[2]=h*u-f*o+p*i,t[3]=-h*s+f*a-l*i,t},e.lerp=function(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=e[3];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=o+n*(r[2]-o),t[3]=s+n*(r[3]-s),t},e.random=function(t,e){var r,n,a,o,s,u;e=e||1;do{s=(r=2*i.RANDOM()-1)*r+(n=2*i.RANDOM()-1)*n}while(s>=1);do{u=(a=2*i.RANDOM()-1)*a+(o=2*i.RANDOM()-1)*o}while(u>=1);var c=Math.sqrt((1-s)/u);return t[0]=e*r,t[1]=e*n,t[2]=e*a*c,t[3]=e*o*c,t},e.transformMat4=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,t[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,t[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,t[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,t},e.transformQuat=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],s=r[1],u=r[2],c=r[3],h=c*n+s*a-u*i,f=c*i+u*n-o*a,l=c*a+o*i-s*n,p=-o*n-s*i-u*a;return t[0]=h*c+p*-o+f*-u-l*-s,t[1]=f*c+p*-s+l*-o-h*-u,t[2]=l*c+p*-u+h*-s-f*-o,t[3]=e[3],t},e.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},e.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],s=e[0],u=e[1],c=e[2],h=e[3];return Math.abs(r-s)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-u)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-c)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(o-h)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))},e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0;var i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=t[o]}return r.default=t,e&&e.set(t,r),r}(r(926));function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function o(){var t=new i.ARRAY_TYPE(4);return i.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function s(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function u(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function c(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function h(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return Math.hypot(r,n,i,a)}function f(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return r*r+n*n+i*i+a*a}function l(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.hypot(e,r,n,i)}function p(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}var d=s;e.sub=d;var m=u;e.mul=m;var v=c;e.div=v;var b=h;e.dist=b;var y=f;e.sqrDist=y;var E=l;e.len=E;var M=p;e.sqrLen=M;var g,_=(g=o(),function(t,e,r,n,i,a){var o,s;for(e||(e=4),r||(r=0),s=n?Math.min(n*e+r,t.length):t.length,o=r;o<s;o+=e)g[0]=t[o],g[1]=t[o+1],g[2]=t[o+2],g[3]=t[o+3],i(g,g,a),t[o]=g[0],t[o+1]=g[1],t[o+2]=g[2],t[o+3]=g[3];return t});e.forEach=_}},e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}(()=>{class t{constructor(){this.init("")}init(t){this.src=t,this.p=0}adv(t){this.p+=t}isDone(){return this.p>=this.src.length}c(){return this.src[this.p]}isMatch(t){return this.src.startsWith(t,this.p)}getSpace(){let t="";for(;!this.isDone();){const e=this.c();if(" "!==e&&"\n"!==e&&"\t"!==e)break;t+=e,this.adv(1)}return t}getWord(){let t="";for(;!this.isDone();){const e=this.c(),r=e.charCodeAt();if((r<97||r>122)&&45!==r&&95!==r&&(r<65||r>90)&&(r<48||r>57)&&r<128)break;t+=e,this.adv(1)}return t}getTill(t){let e=this.src.indexOf(t,this.p);e=e<0?this.src.length:e;const r=this.src.slice(this.p,e);return this.p=e,r}ignoreTill(t){const e=this.src.indexOf(t,this.p);if(e<0)throw new SyntaxError("Unexpected end of input");this.p=e+t.length}parseTags(){const t=[];for(;!this.isMatch("</");)if(this.isMatch("\x3c!--"))this.ignoreTill("--\x3e");else if("<"===this.c())t.push(this.parseTag());else{const e=this.getSpace();"<"!==this.c()&&t.push(e+this.getTill("<"))}return t}parseTag(){this.adv(1);const t={};if(t.t=this.getWord(),""===t.t)throw new SyntaxError("No tag name");if(t.a=this.parseAttrs(),">"===this.c()){if(this.adv(1),t.c=this.parseTags(),this.adv(2),this.getWord()!==t.t)throw new SyntaxError("Start and end tag name do not match");if(this.getSpace(),">"!==this.c())throw new SyntaxError("Tag is not closed");this.adv(1)}else{if(!this.isMatch("/>"))throw new SyntaxError("Tag is not closed");t.c=[],this.adv(2)}return t}parseAttrs(){const t={};for(;;){this.getSpace();const e=this.getWord();if(""===e)break;let r;if("="===this.c()){this.adv(1);const t=this.c();if('"'!==t&&"'"!==t)throw new SyntaxError("Attribute value does not start with \" or '");this.adv(1),r=this.getTill(t),this.adv(1)}else r=e;t[e]=r}return t}parse(t){this.init(t+"</");const e=this.parseTags();if(this.p!==this.src.length-2)throw new SyntaxError("Unexpected end tag");if(1!==e.length)throw new Error("Create only one root element in your template");return this.init(""),e[0]}}const e=new WeakMap;class n{static parse(e){return(new t).parse(e)}static build(t,e=null,r=Object.create(null)){if("string"==typeof t)return document.createTextNode(t);if(r[t.t]){const i={};for(const[r,n]of Object.entries(t.a))e&&"on"===r.slice(0,2)?i[r]=new Function("event",n).bind(e):e&&"id"!==r&&(i[r]=n);const a=t.c.map((t=>n.build(t,e,r))),o=new r[t.t](i,a);return e&&t.a&&t.a.id&&(e[t.a.id]=o),o.element}{const i=document.createElement(t.t);for(const[r,n]of Object.entries(t.a))e&&"id"===r?e[n]=i:e&&"on"===r.slice(0,2)?i[r]=new Function("event",n).bind(e):i.setAttribute(r,n);for(const a of t.c)i.appendChild(n.build(a,e,r));return i}}static create(t,e={},r){return n.createElement(t,e,r),e}static createElement(t,e,r){const i=n.build(n.parse(t),e,r);return n.bindElement(e,i),i}static bindElement(t,r){null!=t&&null==t.element&&(t.element=r,e.set(r,t))}static from(t){return e.get(t)}static camelToKebab(t){return t.replace(/(\w)([A-Z])/g,"$1-$2").toLowerCase()}constructor(){Object.prototype.hasOwnProperty.call(this.constructor,"_parsedTemplate")||(this.constructor._parsedTemplate=n.parse(this.template()));const t=n.build(this.constructor._parsedTemplate,this,this.constructor._SubComponents);n.bindElement(this,t)}template(){throw new Error('Please override "template()" method in the class extends TComponent')}uses(...t){Object.prototype.hasOwnProperty.call(this.constructor,"_SubComponents")||(this.constructor._SubComponents=Object.create(null));const e=this.constructor._SubComponents;for(const r of t)e[r.name]=r,e[n.camelToKebab(r.name)]=r}}n.version="0.2.2";const i=n,a=t=>Array.isArray(t)?t:Array.from(t);class o{constructor(t){this._ite=t}concat(...t){return new o([this._ite,...t]).flat()}entries(){return this.map(((t,e)=>[e,t]))}every(t,e=null){return!this.map(t,e).map((t=>!!t)).includes(!1)}fill(t,e=0,r=Number.MAX_SAFE_INTEGER){return e<0||r<0?new o(a(this._ite).fill(...arguments)):this.map(((n,i)=>i>=e&&i<r?t:n))}filter(t,e=null){return this.flatMap(((r,n,i)=>t.call(e,r,n,i)?[r]:[]))}find(t,e=null){for(const[r,n]of this.entries())if(t.call(e,n,r,this._ite))return n}findIndex(t,e=null){for(const[r,n]of this.entries())if(t.call(e,n,r,this._ite))return r;return-1}flat(t=1){return new o(function*t(e,r){for(const n of e)r>0&&"function"==typeof n[Symbol.iterator]?yield*t(n,r-1):yield n}(this._ite,t))}flatMap(t,e){return this.map(t,e).flat()}forEach(t,e=null){this.map(t,e).fill(0).indexOf(1)}includes(t,e=0){return this.indexOf(t,e)>=0}indexOf(t,e=0){return e<0?a(this._ite).indexOf(...arguments):this.findIndex(((r,n)=>n>=e&&r===t))}join(t=","){return a(this._ite).join(...arguments)}keys(){return this.map(((t,e)=>e))}lastIndexOf(t,e){return a(this._ite).lastIndexOf(...arguments)}map(t,e=null){return new o(function*(r,n){for(const i of r)yield t.call(e,i,++n,r)}(this._ite,-1))}reduce(t,e){let r=e;for(const[e,n]of this.entries())r=0===e&&1===arguments.length?n:t(r,n,e,this._ite);return r}reduceRight(t,e){return a(this._ite).reduceRight(...arguments)}slice(t=0,e=Number.MAX_SAFE_INTEGER){return new o(t<0||e<0?a(this._ite).slice(...arguments):function*(r,n){for(const i of r){if(++n>=e)return;n>=t&&(yield i)}}(this._ite,-1))}some(t,e=null){return this.map(t,e).map((t=>!!t)).includes(!0)}toString(){return this.join("")}values(){return new o(this._ite)}[Symbol.iterator](){return this._ite[Symbol.iterator]()}}function s(t){if("number"==typeof t)return new o(Array(t).keys());if("function"==typeof t[Symbol.iterator])return new o(t);throw new TypeError("The given argument is not a number or iterable.")}var u=r(16),c=r(529),h=r(765);v.VERSION="0.3.30";var f=window.WebGLRenderingContext||{},l={};l[f.FLOAT]={type:f.FLOAT,size:1,fn:"1f",isMatrix:!1},l[f.FLOAT_VEC2]={type:f.FLOAT,size:2,fn:"2fv",isMatrix:!1},l[f.FLOAT_VEC3]={type:f.FLOAT,size:3,fn:"3fv",isMatrix:!1},l[f.FLOAT_VEC4]={type:f.FLOAT,size:4,fn:"4fv",isMatrix:!1},l[f.FLOAT_MAT2]={type:f.FLOAT,size:4,fn:"2fv",isMatrix:!0},l[f.FLOAT_MAT3]={type:f.FLOAT,size:9,fn:"3fv",isMatrix:!0},l[f.FLOAT_MAT4]={type:f.FLOAT,size:16,fn:"4fv",isMatrix:!0};var p={};function d(){}p[f.BYTE]={byte:1,Array:window.Int8Array},p[f.UNSIGNED_BYTE]={byte:1,Array:window.Uint8Array},p[f.SHORT]={byte:2,Array:window.Int16Array},p[f.UNSIGNED_SHORT]={byte:2,Array:window.Uint16Array},p[f.INT]={byte:4,Array:window.Int32Array},p[f.UNSIGNED_INT]={byte:4,Array:window.Uint32Array},p[f.FLOAT]={byte:4,Array:window.Float32Array};var m=[];function v(t,e){if(!(this instanceof v))throw new Error("Should call as new Gls()");(e=Object.create(e||null)).PI=Math.PI;for(var r=0,n=m.length;r<n;r++)m[r].call(this,t,e)}function b(t,e,r){var n;if(this.gl=t,this.shader=t.createShader(e),t.shaderSource(this.shader,r),t.compileShader(this.shader),!t.getShaderParameter(this.shader,f.COMPILE_STATUS))throw n=e===f.VERTEX_SHADER?"Vertex":e===f.FRAGMENT_SHADER?"Fragment":"Unknown",new Error(n+" shader compile error: "+t.getShaderInfoLog(this.shader))}function y(t,e,r){b.call(this,t,f.VERTEX_SHADER,e),this.attribute=r}function E(t,e){b.call(this,t,f.FRAGMENT_SHADER,e)}function M(t,e,r,n){var i;return r=function(t){return t.replace(/(\/\/.*\n)|(\/\**?\*\/)/g,(function(t){return new Array(t.split("\n").length).join("\n")+" "}))}(r),e===y&&(i=function(t){t=";"+t.replace(/;/g,";;");for(var e,r=/;\s*attribute\s+(\w+\s+)?\[\[(ushort2|ubyte4)\]\]\s+(\w+)\s*;/g,n=Object.create(null);null!==(e=r.exec(t));){var i=e[2],a=e[3],o="ushort2"===i?f.UNSIGNED_SHORT:"ubyte4"===i?f.UNSIGNED_BYTE:null;n[a]={type:o}}return n}(r)),new e(t,r=function(t,e){return t.replace(/\[\[(.+?)\]\]/g,(function(t,r){var n,i,a=e;for(r=r.split("."),n=0;n<r.length&&null!=(i=a[r[n]]);n++)a=i;return null==i?"":"number"==typeof i?i.toFixed(8):""+i}))}(r,n),i)}m.push((function(t,e){if("string"==typeof t&&(t=document.querySelector(t)),!(t instanceof HTMLCanvasElement))throw new Error("Canvas element was not found");e.canvas=Object.create(e.canvas||null),e.canvas.width=t.width,e.canvas.height=t.height,this.canvas=t})),m.push((function(t,e){for(var r,n,i={preserveDrawingBuffer:!0},a=["alpha","desynchronized","antialias","depth","failIfMajorPerformanceCaveat","powerPreference","premultipliedAlpha","preserveDrawingBuffer","stencil"],o=0;o<a.length;o++){var s=a[o];s in e&&(i[s]=e[s])}if(!(r=this.canvas.getContext("webgl",i)||this.canvas.getContext("experimental-webgl",i)))throw(n=document.createElement("div")).innerHTML=this.canvas.innerHTML,this.canvas.parentNode.replaceChild(n,this.canvas),new Error("WebGL is not supported");this.gl=r})),m.push((function(t,e){function r(t,r,n){var i,a,o,s,u,c,h,f;for(i=t.canvas.querySelectorAll(n),a=Object.create(null),o=0;o<i.length;o++)for(u=((s=i[o]).getAttribute("data-name")||"").split(","),c=M(t,r,s.textContent,e),h=0;h<u.length;h++){if(a[f=u[h]])throw new Error("Duplicate shader name: "+f);a[f]=c}return a}e.ushort2="vec2",e.ubyte4="vec4",this._shader=Object.create(null),this._shader.vertex=r(this.gl,y,'script[type="x-shader/x-vertex"]'),this._shader.fragment=r(this.gl,E,'script[type="x-shader/x-fragment"]')}));var g=[];function _(t,e,r,n){if(t.gl!==r.gl||t.gl!==n.gl)throw new Error("Different context");this.name=e,this._gls=t;for(var i=0,a=g.length;i<a;i++)g[i].call(this,r,n)}function A(t,e){var r,n,i;for(r in e){if(i=e[r],n=t[r]){if(null!=n.size&&n.size!==i.size)throw new Error("Same attribute but size is different: "+r);if(null!=n.type&&n.type!==i.type)throw new Error("Same attribute but type is different: "+r+" ("+n.type+" != "+i.type+")")}else t[r]={};t[r].size=i.size,t[r].type=i.type}}function R(){var t,e,r,n,i,a=this._attribute,o=this._gls.gl;for(t=o.getProgramParameter(this._program,f.ACTIVE_ATTRIBUTES),e=0;e<t;e++)n=(r=o.getActiveAttrib(this._program,e)).name,i=l[r.type],a[n]=a[n]||{},a[n].size=a[n].size||i.size,a[n].type=a[n].type||i.type,a[n].location=e}function T(t,e){if(!e.vbo){var r,n=this._gls.gl;r=n.getParameter(f.ARRAY_BUFFER_BINDING),e.vbo=n.createBuffer(),n.bindBuffer(f.ARRAY_BUFFER,e.vbo),n.bufferData(f.ARRAY_BUFFER,e.vertexes,t.usage),n.bindBuffer(f.ARRAY_BUFFER,r),e.indices&&(r=n.getParameter(f.ELEMENT_ARRAY_BUFFER_BINDING),e.ibo=n.createBuffer(),n.bindBuffer(f.ELEMENT_ARRAY_BUFFER,e.ibo),n.bufferData(f.ELEMENT_ARRAY_BUFFER,e.indices,t.usage),n.bindBuffer(f.ELEMENT_ARRAY_BUFFER,r))}}function w(t,e){var r=this._gls.gl,n=this._gls._oesvao;if(n){if(e.vao[this.name])return void n.bindVertexArrayOES(e.vao[this.name]);e.vao[this.name]=n.createVertexArrayOES(),n.bindVertexArrayOES(e.vao[this.name])}var i,a,o,s=t.attribute;for(i in r.bindBuffer(f.ARRAY_BUFFER,e.vbo),this._attribute)a=this._attribute[i],o=s[i],r.enableVertexAttribArray(a.location),r.vertexAttribPointer(a.location,a.size,a.type,!1,t.strideSize,o.offset);e.ibo&&r.bindBuffer(f.ELEMENT_ARRAY_BUFFER,e.ibo)}function S(){var t,e,r,n,i,a,o=this._gls,s=o.gl;for(e=s.getProgramParameter(this._program,f.ACTIVE_UNIFORMS),t=0;t<e;t++)n=(r=s.getActiveUniform(this._program,t)).name,i=l[r.type],a=s.getUniformLocation(this._program,n),i.isMatrix?this._uniformFn[n]=s["uniformMatrix"+i.fn].bind(s,a,!1):i.type===f.SAMPLER_2D?(o._textureBinder||(o._textureBinder=new U(s)),this._uniformFn[n]=o._textureBinder.bind.bind(o._textureBinder,a)):this._uniformFn[n]=s["uniform"+i.fn].bind(s,a)}function x(){var t,e,r,n,i=this.uniform;for(e=0,r=(t=Object.keys(i)).length;e<r;e++){n=t[e];var a=this._uniformFn[n],o=i[n];o.texture&&(o=o.texture),"function"==typeof a&&a(o),o instanceof WebGLTexture||(this._uniformSrc[n]=i[n],delete i[n])}}function O(t,e){this._arr=t,this._offset=e}g.push((function(t,e){var r=this._gls.gl,n=r.createProgram();if(r.attachShader(n,t.shader),r.attachShader(n,e.shader),r.linkProgram(n),!r.getProgramParameter(n,f.LINK_STATUS))throw new Error("Link error: "+r.getProgramInfoLog(n));this._program=n})),_.prototype.draw=function(t){if(B.call(t),t.programs.indexOf(this)<0)throw new Error("Using a program with a different geometry");this._gls.gl.useProgram(this._program),x.call(this);for(var e=0;e<t.buffers.length;e++){var r=t.buffers[e];T.call(this,t,r),w.call(this,t,r),t.buffers[0].indices?this._gls.gl.drawElements(t.mode,r.indices.length,r.type,0):this._gls.gl.drawArrays(t.mode,0,r.vertexes.byteLength/t.strideSize)}},m.push((function(t,e){var r=this._shader,n=Object.create(null);for(var i in r.vertex){var a=r.vertex[i],o=r.fragment[i];o&&(n[i]=new _(this,i,a,o),this[i]||(this[i]=n[i]))}this._program=n})),v.prototype.createProgram=function(t,e,r){var n=Object.create(r||null);n.ushort2="vec2",n.ubyte4="vec4";var i=M(this.gl,y,t,n),a=M(this.gl,E,e,n);return new _(this,"t_"+Date.now(),i,a)},g.push((function(t){this._attribute=Object.create(null),A(this._attribute,t.attribute),R.call(this)})),m.push((function(t){this._oesvao=this.gl.getExtension("OES_vertex_array_object")})),g.push((function(){this._uniformFn=Object.create(null),this._uniformSrc=Object.create(null),this.uniform=Object.create(this._uniformSrc),S.call(this)}));for(var P=[{n:"0",p:0},{n:"1",p:1},{n:"2",p:2},{n:"3",p:3},{n:"x",p:0},{n:"y",p:1},{n:"z",p:2},{n:"w",p:3},{n:"r",p:0},{n:"g",p:1},{n:"b",p:2},{n:"a",p:3}],I=0;I<P.length;I++)!function(t){Object.defineProperty(O.prototype,t.n,{set:function(e){this._arr[this._offset+t.p]=e},get:function(){return this._arr[this._offset+t.p]}})}(P[I]);function F(t,e,r){if(this.vao=Object.create(null),this.vertexes=new ArrayBuffer(r*t),e){if(t<=256)this.type=f.UNSIGNED_BYTE;else{if(!(t<=65536))throw new Error("Number of vertices exceeds the upper limit");this.type=f.UNSIGNED_SHORT}this.indices=new p[this.type].Array(e)}}function N(t,e,r,n){for(var i,a,o,s,u=[],c=t,h=t+e;c<h;c++){for(o in i=Object.create(null),n)a=n[o],s=new O(new p[a.type].Array(this.vertexes,c*r+a.offset,a.size),0),1===a.size?function(t){Object.defineProperty(i,o,{get:function(){return t[0]},set:function(e){t[0]=e}})}(s):i[o]=s;u.push(i)}return u}function L(t,e){return this.indices?this.indices.subarray(t,t+e):null}function D(t,e,r,n){this.programs=e,this.mode=null!=r?r:t.TRIANGLE_STRIP,this.usage=null!=n?n:t.DYNAMIC_DRAW,this.attribute=Object.create(null);for(var i=0;i<e.length;i++)A(this.attribute,e[i]._attribute);var a=0;for(var o in this.attribute){var s=this.attribute[o];s.offset=a,a+=p[s.type].byte*s.size}this.strideSize=a,this.allocated=[],this.buffers=[],this.currBufferSize=0,this.currIndexBufferSize=0}function B(){if(0!==this.allocated.length){for(var t=new F(this.currBufferSize,this.currIndexBufferSize,this.strideSize),e=0,r=0,n=0;e<this.allocated.length;e++){var i=this.allocated[e],a=N.call(t,r,i.size,this.strideSize,this.attribute),o=L.call(t,n,i.indexSize);if(i.callback.call(null,a,o),o&&r>0)for(var s=0;s<o.length;s++)o[s]+=r;r+=i.size,n+=i.indexSize}this.buffers.push(t),this.allocated.length=0,this.currBufferSize=0,this.currIndexBufferSize=0}}function U(t){this.gl=t,this.max=Math.max(2,t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS)),this.units=[]}function j(t){var e,r;for(r=0;r<this.units.length;r++)if((e=this.units[r]).locations.indexOf(t)>=0)return e}function Y(t){var e,r;for(r=0;r<this.units.length;r++)if((e=this.units[r]).texture===t)return e}function z(t){var e=C.call(this);return this.gl.activeTexture(this.gl["TEXTURE"+e]),this.gl.bindTexture(this.gl.TEXTURE_2D,t),{number:e,locations:[],texture:t}}function C(){var t,e=new Array(this.max);for(this.units=this.units.slice(1-this.max),t=0;t<this.units.length;t++)e[this.units[t].number]=!0;for(t=0;t<e.length;t++)if(!e[t])return t}function G(t,e){t.locations.push(e),this.gl.uniform1i(e,t.number)}function X(t,e){t.locations.splice(t.locations.indexOf(e),1),0===t.locations.length&&this.units.splice(this.units.indexOf(t),1)}function q(t){var e=this.units.indexOf(t);e>=0&&this.units.splice(e,1),this.units.push(t)}function W(t,e){var r,n,i=!e.MIN_FILTER;for(r in e)n=e[r],"MIN_FILTER"===r&&"NEAREST"!==n&&"LINEAR"!==n&&(i=!0),t.texParameteri(t.TEXTURE_2D,t["TEXTURE_"+r],t[n]);i&&t.generateMipmap(t.TEXTURE_2D)}function k(t,e){(e=Object.create(e||{})).width=e.width||t.canvas.width,e.height=e.height||t.canvas.height,e.texture=e.texture||t.NEAREST_CLAMP,e.depth=!1!==e.depth,V.call(this,t.gl,e),this.width=e.width,this.height=e.height}function V(t,e){var r=t.getParameter(t.FRAMEBUFFER_BINDING),n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n);var i,a=null;!1!==e.depth&&(i=t.getParameter(t.RENDERBUFFER_BINDING),a=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,a),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,a),t.bindRenderbuffer(t.RENDERBUFFER,i));var o=t.getParameter(t.TEXTURE_BINDING_2D),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e.width,e.height,0,t.RGBA,t.UNSIGNED_BYTE,null),W(t,e.texture),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0),t.bindTexture(t.TEXTURE_2D,o),t.bindFramebuffer(t.FRAMEBUFFER,r),this.framebuffer=n,this.depthRenderbuffer=a,this.texture=s}D.prototype.allocate=function(t,e,r){this.currBufferSize+t>65536&&B.call(this),this.allocated.push({size:t,indexSize:e,callback:r||d}),this.currBufferSize+=t,this.currIndexBufferSize+=e},v.prototype.createGeometry=function(t,e,r){t=t.slice();for(var n=0;n<t.length;n++){var i=t[n];"string"==typeof i&&(t[n]=this._program[i])}return new D(this.gl,t,e,r)},l[f.SAMPLER_2D]={type:f.SAMPLER_2D,size:1,fn:"1i",isMatrix:!1},U.prototype.bind=function(t,e){var r=j.call(this,t);if(r){if(r.texture===e)return q.call(this,r);X.call(this,r,t)}e&&((r=Y.call(this,e))||(r=z.call(this,e)),G.call(this,r,t),q.call(this,r))},v.prototype.createTexture=function(t,e){return function(t,e,r){r=r||{};var n=t.getParameter(t.TEXTURE_BINDING_2D),i=t.createTexture();return t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),W(t,r),t.bindTexture(t.TEXTURE_2D,n),i}(this.gl,t,e)},v.prototype.NEAREST_CLAMP={MIN_FILTER:"NEAREST",MAG_FILTER:"NEAREST",WRAP_S:"CLAMP_TO_EDGE",WRAP_T:"CLAMP_TO_EDGE"},v.prototype.LINEAR_CLAMP={MIN_FILTER:"LINEAR",MAG_FILTER:"LINEAR",WRAP_S:"CLAMP_TO_EDGE",WRAP_T:"CLAMP_TO_EDGE"},v.prototype.NEAREST_REPEAT={MIN_FILTER:"NEAREST",MAG_FILTER:"NEAREST",WRAP_S:"REPEAT",WRAP_T:"REPEAT"},v.prototype.LINEAR_REPEAT={MIN_FILTER:"LINEAR",MAG_FILTER:"LINEAR",WRAP_S:"REPEAT",WRAP_T:"REPEAT"},v.prototype.createFramebuffer=function(t){return new k(this,t)},v.prototype.bindFramebuffer=function(t){t?(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,t.framebuffer),this.gl.viewport(0,0,t.width,t.height)):(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.viewport(0,0,this.canvas.width,this.canvas.height))};var H=0;function Z(t,e,r,n){this._geom,this.ucount=e,this.vcount=r;var i=[];this._callbacks=i;var a=(e+1)*(r+1),o=(2*e+4)*r;t.allocate(a,o,(function(t,a){!function(t,e,r,n,i){var a,o,s;i=i||"position";var u=r+1;for(o=0,s=0;o<=n;o++)for(a=0;a<u;a++,s++)t[s][i][0]=a/r*2-1,t[s][i][1]=o/n*2-1;for(o=0,s=0;o<n;o++){for(e[s++]=o*u,a=0;a<u;a++)e[s++]=a+o*u,e[s++]=a+(o+1)*u;e[s++]=a-1+(o+1)*u}}(t,a,e,r,n);for(var o=0;o<i.length;o++)for(var s=i[o],u=0;u<t.length;u++)s(t[u])}))}function K(t,e){this.x=e.x||0,this.y=e.y||0,this.z=e.z||0,this.delayX=e.delayX||e.delay||0,this.delayY=e.delayY||e.delay||0,this.delayZ=e.delayZ||e.delay||0,this[0]=this.dispX=this.x,this[1]=this.dispY=this.y,this[2]=this.dispZ=this.z,t.canvas.addEventListener("mousemove",function(t){var e=t.target.getBoundingClientRect();this.x=(t.pageX-e.left-window.pageXOffset)/e.width*2-1,this.y=1-(t.pageY-e.top-window.pageYOffset)/e.height*2}.bind(this)),t.canvas.addEventListener("mousewheel",function(t){this.z+=t.wheelDelta}.bind(this),{passive:!0})}m.push((function(t,e){H=f.COLOR_BUFFER_BIT|(!1!==e.depth?f.DEPTH_BUFFER_BIT:0)|(!0===e.stencil?f.STENCIL_BUFFER_BIT:0),!1!==e.depth&&(this.gl.enable(f.DEPTH_TEST),this.gl.clearDepth(1))})),v.prototype.clear=function(t){this.gl.clear(H|t)},["clearColor","enable","disable","blendFunc","blendFuncSeparate","viewport"].forEach((function(t){v.prototype[t]=function(){this.gl[t].apply(this.gl,arguments)}})),["POINTS","LINES","LINE_STRIP","TRIANGLES","TRIANGLE_STRIP","CULL_FACE","BLEND","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","ONE","ZERO"].forEach(function(t){v[t]=v.prototype[t]=f[t]}.bind(void 0)),Z.prototype.transform=function(t){return this._callbacks.push(t),this},D.prototype.createMesh=function(t,e,r){return new Z(this,t,e,r)},K.prototype.update=function(){this[0]=this.dispX=this.dispX*this.delayX+this.x*(1-this.delayX),this[1]=this.dispY=this.dispY*this.delayY+this.y*(1-this.delayY),this[2]=this.dispZ=this.dispZ*this.delayZ+this.z*(1-this.delayZ)},v.prototype.createMouse=function(t){return new K(this,t||{})},v.prototype.createCamera=function(t){var e=u.fromValues(-t.x||0,-t.y||0,-t.z||0),r=c.G3(c.Ue(),t.fov*Math.PI/180,this.canvas.width/this.canvas.height,t.near,t.far);return function(t){var n=h.Ue();h.jI(n,n,(t.roll||0)*Math.PI/180),h.lM(n,n,(t.tilt||0)*Math.PI/180),h.uD(n,n,(t.pan||0)*Math.PI/180);var i=c.yl(c.Ue(),n,e),a=c.dC(c.Ue(),r,i);return c.Iu(a,a,u.fromValues(-t.x||0,-t.y||0,-t.z||0)),a}};const Q=v;var $=r(146);const J=new class extends i{template(){return'\n      <div>\n        <h1>box</h1>\n        <canvas id="canvas" width="600" height="600">\n          WebGL is not available.\n        </canvas>\n      </div>\n    '}mainVertexShader(){return"\n      attribute vec3 position;\n      attribute vec3 normal;\n      attribute [[ubyte4]] color;\n      uniform mat4 mvp;\n      uniform float time;\n      varying vec3 vColor;\n\n      void main() {\n        vec4 tp = mvp * vec4(position, 1.0);          // 視点から見た頂点座標\n        vec4 tn = mvp * vec4(position + normal, 1.0); // 視点から見た頂点+頂点の法線ベクトル\n        vec3 normal_v = normalize(tn.xyz - tp.xyz);   // 視点から見た頂点の法線ベクトル\n        vec3 camera_v = vec3(0.0, 0.0, -1.0);         // 視線ベクトル\n        float lightness = dot(normal_v, camera_v);    // 視点から見た頂点の法線ベクトルと視線ベクトルのドット積\n\n        gl_Position = tp;\n        vColor = 1.0 - (1.0 - color.rgb / 255.0) * (1.0 - pow(1.0 - lightness, 3.0) * 0.4);\n      }\n    "}mainFlagmentShader(){return"\n      precision mediump float;\n      varying vec3 vColor;\n      void main() {\n        gl_FragColor = vec4(vColor, 1.0);\n      }\n    "}constructor(){super(),this.gl=new Q(this.canvas,{alpha:!0,antialias:!0,depth:!0}),this.gl.clearColor(.9,.8,.7,1),this.gl.enable(this.gl.CULL_FACE),this.shader=this.gl.createProgram(this.mainVertexShader(),this.mainFlagmentShader()),this.mouse=this.gl.createMouse({delay:.9}),this.camera=this.gl.createCamera({fov:45,near:.1,far:100,z:10}),this.geom=this.gl.createGeometry([this.shader]);for(const t of s(25)){const e=t%5-2,r=(t/5|0)-2,n=3*Math.random()|0;for(const t of s(6))this.geom.createMesh(5,5).transform((i=>{const a=i.position;switch(a.z+=1,u.rotateX(a,u.fromValues(a.x,0,a.z),u.create(),a.y*Math.PI/-4),u.rotateY(a,u.fromValues(0,a.y,a.z),u.create(),a.x*Math.PI/4),t<4?u.rotateY(a,a,u.create(),t*Math.PI/2):u.rotateX(a,a,u.create(),(t+.5)*Math.PI),u.copy(i.normal,a),u.scale(a,a,.2),a.x+=.83*Math.sign(a.x),a.y+=.83*Math.sign(a.y),a.z+=.83*Math.sign(a.z),a.x+=2*e,a.z+=2*r,n){case 0:$.set(i.color,96,128,224,255);break;case 1:$.set(i.color,128,192,32,255);break;case 2:$.set(i.color,224,64,160,255)}}))}}loop(t){this.mouse.update(),this.gl.clear(),this.shader.uniform.time=(new Date).getTime()/1e3%86400,this.shader.uniform.mvp=this.camera({pan:180*this.mouse.dispX,tilt:-90*this.mouse.dispY}),this.shader.draw(this.geom)}};document.body.appendChild(J.element),J.main&&J.main(),J.loop&&function t(e){window.requestAnimationFrame(t),J.loop(e)}(0),window.app=J})()})();